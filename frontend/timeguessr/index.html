<html>
<head>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body>

    <div id="todays-leaderboard">
        <h1>Today's Timeguessr Scores</h1>
        <div id="leaderboard">Loading...</div>
    </div>

    <div id="weekly-leaderboard">
        <h1>This Week's Timeguessr Scores</h1>
        <div id="w-leaderboard">Loading...</div>
    </div>
    
</body>
</html>
<script>
    const API_URL = window.location.hostname === 'localhost' 
            ? 'http://localhost:8080'
            : '';

    

    async function fetchTodaysScores() {
        const response = await fetch(`${API_URL}/api/todays`);
        data = await response.json();
        
        for (let i = 0; i < data.length; i++) {
            data[i] = `${data[i].rank}. ${data[i].username} - ${data[i].score} points <br>`;
        }
        document.getElementById('leaderboard').innerHTML = data.join('\n') ;
        console.log(response.length == 0);
        }

    async function fetchWeeklyScores() {
        const response = await fetch(`${API_URL}/api/weekly-scores`);
        data = await response.json();
        
        for (let i = 0; i < data.length; i++) {
            data[i] = `${i+1}. ${data[i].username} - ${parseInt(data[i].avg_score)} points <br>`;
        }
        document.getElementById('w-leaderboard').innerHTML = data.join('\n') ;
        }
    
    
    fetchTodaysScores();
    fetchWeeklyScores();
</script>